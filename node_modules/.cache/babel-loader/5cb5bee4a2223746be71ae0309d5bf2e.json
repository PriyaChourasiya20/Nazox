{"ast":null,"code":"import { takeEvery, fork, put, all, call } from \"redux-saga/effects\"; // Login Redux States\n\nimport { CHECK_LOGIN, LOGOUT_USER } from \"./actionTypes\";\nimport { apiError, loginUserSuccessful, logoutUserSuccess } from \"./actions\"; // AUTH related methods\n\nimport { postLogin } from \"../../../helpers/fackBackend_Helper\";\nimport { getFirebaseBackend } from \"../../../helpers/firebase_helper\"; //Initilize firebase\n\nconst fireBaseBackend = getFirebaseBackend(); //If user is login then dispatch redux action's are directly from here.\n\nfunction* loginUser(_ref) {\n  let {\n    payload: {\n      user,\n      history\n    }\n  } = _ref;\n  console.log(user, history, \"history user\");\n\n  try {\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\n      const response = yield call(fireBaseBackend.loginUser, user.username, user.password);\n      yield put(loginUserSuccessful(response));\n    } else {\n      const response = yield call(postLogin, \"/api/login\", {\n        username: user.username,\n        password: user.password\n      });\n      localStorage.setItem(\"authUser\", JSON.stringify(response));\n      console.log(\"response\", response);\n      yield put(loginUserSuccessful(response));\n    }\n\n    history.push(\"/dashboard\");\n  } catch (error) {\n    console.log(\"saga error\");\n    yield put(apiError(error));\n  }\n}\n\nfunction* logoutUser(_ref2) {\n  let {\n    payload: {\n      history\n    }\n  } = _ref2;\n\n  try {\n    localStorage.removeItem(\"authUser\");\n\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\n      const response = yield call(fireBaseBackend.logout);\n      yield put(logoutUserSuccess(response));\n    }\n\n    history.push(\"/login\");\n  } catch (error) {\n    yield put(apiError(error));\n  }\n}\n\nexport function* watchUserLogin() {\n  yield takeEvery(CHECK_LOGIN, loginUser);\n}\nexport function* watchUserLogout() {\n  yield takeEvery(LOGOUT_USER, logoutUser);\n}\n\nfunction* loginSaga() {\n  yield all([fork(watchUserLogin), fork(watchUserLogout)]);\n}\n\nexport default loginSaga;","map":{"version":3,"names":["takeEvery","fork","put","all","call","CHECK_LOGIN","LOGOUT_USER","apiError","loginUserSuccessful","logoutUserSuccess","postLogin","getFirebaseBackend","fireBaseBackend","loginUser","payload","user","history","console","log","process","env","REACT_APP_DEFAULTAUTH","response","username","password","localStorage","setItem","JSON","stringify","push","error","logoutUser","removeItem","logout","watchUserLogin","watchUserLogout","loginSaga"],"sources":["/home/rovi91/Downloads/copy (new)/src/store/auth/login/saga.js"],"sourcesContent":["import { takeEvery, fork, put, all, call } from \"redux-saga/effects\";\r\n\r\n// Login Redux States\r\nimport { CHECK_LOGIN, LOGOUT_USER } from \"./actionTypes\";\r\nimport { apiError, loginUserSuccessful, logoutUserSuccess } from \"./actions\";\r\n\r\n// AUTH related methods\r\nimport { postLogin } from \"../../../helpers/fackBackend_Helper\";\r\nimport { getFirebaseBackend } from \"../../../helpers/firebase_helper\";\r\n\r\n//Initilize firebase\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n//If user is login then dispatch redux action's are directly from here.\r\nfunction* loginUser({ payload: { user, history } }) {\r\n  console.log(user, history, \"history user\");\r\n  try {\r\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n      const response = yield call(\r\n        fireBaseBackend.loginUser,\r\n        user.username,\r\n        user.password\r\n      );\r\n      yield put(loginUserSuccessful(response));\r\n    } else {\r\n      const response = yield call(postLogin, \"/api/login\", {\r\n        username: user.username,\r\n        password: user.password,\r\n      });\r\n      localStorage.setItem(\"authUser\", JSON.stringify(response));\r\n      console.log(\"response\", response);\r\n      yield put(loginUserSuccessful(response));\r\n    }\r\n    history.push(\"/dashboard\");\r\n  } catch (error) {\r\n    console.log(\"saga error\");\r\n    yield put(apiError(error));\r\n  }\r\n}\r\n\r\nfunction* logoutUser({ payload: { history } }) {\r\n  try {\r\n    localStorage.removeItem(\"authUser\");\r\n\r\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n      const response = yield call(fireBaseBackend.logout);\r\n      yield put(logoutUserSuccess(response));\r\n    }\r\n\r\n    history.push(\"/login\");\r\n  } catch (error) {\r\n    yield put(apiError(error));\r\n  }\r\n}\r\n\r\nexport function* watchUserLogin() {\r\n  yield takeEvery(CHECK_LOGIN, loginUser);\r\n}\r\n\r\nexport function* watchUserLogout() {\r\n  yield takeEvery(LOGOUT_USER, logoutUser);\r\n}\r\n\r\nfunction* loginSaga() {\r\n  yield all([fork(watchUserLogin), fork(watchUserLogout)]);\r\n}\r\n\r\nexport default loginSaga;\r\n"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,IAApB,EAA0BC,GAA1B,EAA+BC,GAA/B,EAAoCC,IAApC,QAAgD,oBAAhD,C,CAEA;;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,eAAzC;AACA,SAASC,QAAT,EAAmBC,mBAAnB,EAAwCC,iBAAxC,QAAiE,WAAjE,C,CAEA;;AACA,SAASC,SAAT,QAA0B,qCAA1B;AACA,SAASC,kBAAT,QAAmC,kCAAnC,C,CAEA;;AACA,MAAMC,eAAe,GAAGD,kBAAkB,EAA1C,C,CAEA;;AACA,UAAUE,SAAV,OAAoD;EAAA,IAAhC;IAAEC,OAAO,EAAE;MAAEC,IAAF;MAAQC;IAAR;EAAX,CAAgC;EAClDC,OAAO,CAACC,GAAR,CAAYH,IAAZ,EAAkBC,OAAlB,EAA2B,cAA3B;;EACA,IAAI;IACF,IAAIG,OAAO,CAACC,GAAR,CAAYC,qBAAZ,KAAsC,UAA1C,EAAsD;MACpD,MAAMC,QAAQ,GAAG,MAAMlB,IAAI,CACzBQ,eAAe,CAACC,SADS,EAEzBE,IAAI,CAACQ,QAFoB,EAGzBR,IAAI,CAACS,QAHoB,CAA3B;MAKA,MAAMtB,GAAG,CAACM,mBAAmB,CAACc,QAAD,CAApB,CAAT;IACD,CAPD,MAOO;MACL,MAAMA,QAAQ,GAAG,MAAMlB,IAAI,CAACM,SAAD,EAAY,YAAZ,EAA0B;QACnDa,QAAQ,EAAER,IAAI,CAACQ,QADoC;QAEnDC,QAAQ,EAAET,IAAI,CAACS;MAFoC,CAA1B,CAA3B;MAIAC,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCC,IAAI,CAACC,SAAL,CAAeN,QAAf,CAAjC;MACAL,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBI,QAAxB;MACA,MAAMpB,GAAG,CAACM,mBAAmB,CAACc,QAAD,CAApB,CAAT;IACD;;IACDN,OAAO,CAACa,IAAR,CAAa,YAAb;EACD,CAlBD,CAkBE,OAAOC,KAAP,EAAc;IACdb,OAAO,CAACC,GAAR,CAAY,YAAZ;IACA,MAAMhB,GAAG,CAACK,QAAQ,CAACuB,KAAD,CAAT,CAAT;EACD;AACF;;AAED,UAAUC,UAAV,QAA+C;EAAA,IAA1B;IAAEjB,OAAO,EAAE;MAAEE;IAAF;EAAX,CAA0B;;EAC7C,IAAI;IACFS,YAAY,CAACO,UAAb,CAAwB,UAAxB;;IAEA,IAAIb,OAAO,CAACC,GAAR,CAAYC,qBAAZ,KAAsC,UAA1C,EAAsD;MACpD,MAAMC,QAAQ,GAAG,MAAMlB,IAAI,CAACQ,eAAe,CAACqB,MAAjB,CAA3B;MACA,MAAM/B,GAAG,CAACO,iBAAiB,CAACa,QAAD,CAAlB,CAAT;IACD;;IAEDN,OAAO,CAACa,IAAR,CAAa,QAAb;EACD,CATD,CASE,OAAOC,KAAP,EAAc;IACd,MAAM5B,GAAG,CAACK,QAAQ,CAACuB,KAAD,CAAT,CAAT;EACD;AACF;;AAED,OAAO,UAAUI,cAAV,GAA2B;EAChC,MAAMlC,SAAS,CAACK,WAAD,EAAcQ,SAAd,CAAf;AACD;AAED,OAAO,UAAUsB,eAAV,GAA4B;EACjC,MAAMnC,SAAS,CAACM,WAAD,EAAcyB,UAAd,CAAf;AACD;;AAED,UAAUK,SAAV,GAAsB;EACpB,MAAMjC,GAAG,CAAC,CAACF,IAAI,CAACiC,cAAD,CAAL,EAAuBjC,IAAI,CAACkC,eAAD,CAA3B,CAAD,CAAT;AACD;;AAED,eAAeC,SAAf"},"metadata":{},"sourceType":"module"}